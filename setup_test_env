#!/bin/bash
# file: setup_test_env
# purpose: set up a glideinwms branch "$1" for lint and unit tests
# author: Dennis Box, dbox@fnal.gov

. /usr/local/lib/test_lib.sh

ci_branch="dbox_ci"
if [ "$1" = "" ]; then
    branch="master"
else
    branch=$1
fi

if ! test -d "$TEST_DIR/$PROJECT" ; then
    checkout_branch $branch
    prep_branch $ci_branch
fi

if ! test -f $TEST_DIR/venv-2.${rel}/bin/activate ; then
    cd "$TEST_DIR"
    . "$TEST_DIR/$PROJECT/build/jenkins/utils.sh"
    setup_python_venv
fi
cd $TEST_DIR
rm -rf output || true
mkdir -p output
. $TEST_DIR/venv-2.${rel}/bin/activate 
